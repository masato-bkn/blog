<h1>詳細ページ</h1>

<div class="card card-article">
  <div class="card-header card-article-header">
    <%= @article.title%>
    <p class="date"><%= format_time(@article.created_at) %></p>
  </div>
  <div class="card-body">
    <p class="card-text"><%= @article.content %></p>
    <div class="good-form">
      <%= render 'articles/good_form', {article: @article} %>
    </div>
    <% if user_signed_in? && current_user_article?(@article.id) %>
      <div class="float-right delete-section">
        <%= form_with(model: @article, remote: true, method: :delete) do |f| %>
          <%= f.button :type => "submit", class: "trash-button" do %>
            <i class="fas fa-trash"></i>
          <% end %>
        <% end %>
      </div>
    <% end %>
  </div>
</div>

<% if @article.comments.present? %>
  <div class="comment-area">
    <h3>コメント</h3>
    <% @article.comments.includes(:user).each do |comment| %>
      <div class="element">
        <div class="card">
          <div class="card-header">
            <%= comment.user.name %>
            <p style="float:right"><%= format_time(comment.created_at) %></p>
          </div>
          <div class="card-body">
            <p class="card-text"><%= comment.text%></p>
            <% if user_signed_in? && @ids.include?(comment.id) %>
              <div class="float-right delete-section">
                <%= form_with(model: comment, remote: true, method: :delete) do |f| %>
                  <%= f.button :type => "submit", class: "trash-button" do %>
                    <i class="fas fa-trash"></i>
                  <% end %>
                <% end %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% end %>

<div class="comment-form">
  <%= form_with(model: @article.comments, url: comments_path,) do |f|%>
    <div class="form-group">
      <h3 for="comment_post_form">コメント投稿</h3>
      <%= f.text_area :text, class:"form-control", size: "1x5"%>
    </div>
    <%= f.hidden_field :article_id, value: @article.id %>
    <%= f.hidden_field :user_id, value: @article.user_id %>
    <%= f.submit '送信', class:"btn btn-primary"%>
  <% end %>
</div>
